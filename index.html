<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>particles_v6 probe</title>
  <style>
    html, body { height:100%; margin:0; background:#000; color:#ccc; }
    #app { position:relative; width:100%; height:100%; }
    #scene { position:absolute; inset:0; display:block; }
    #hud { position:absolute; left:8px; top:8px; z-index:10; font:12px/1.3 system-ui; }
  </style>
</head>
<body>
  <div id="app">
    <canvas id="scene"></canvas>
    <div id="hud">boot…</div>
  </div>

  <script>
    // делаем канвас полноэкранным и рисуем тестовую точку
    (function () {
      const c = document.getElementById('scene');
      const hud = document.getElementById('hud');
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      function resize() {
        const r = c.parentElement.getBoundingClientRect();
        c.style.width = r.width + 'px';
        c.style.height = r.height + 'px';
        c.width  = Math.floor(r.width  * dpr);
        c.height = Math.floor(r.height * dpr);
      }
      window.addEventListener('resize', resize);
      resize();
      const ctx = c.getContext('2d');
      let t = 0;
      (function loop() {
        t += 0.02;
        ctx.clearRect(0,0,c.width,c.height);
        ctx.beginPath();
        const x = c.width*0.5 + Math.cos(t)*c.width*0.25;
        const y = c.height*0.5 + Math.sin(t*1.3)*c.height*0.25;
        ctx.arc(x,y,10*dpr,0,Math.PI*2); ctx.fillStyle = '#fff'; ctx.fill();
        requestAnimationFrame(loop);
      })();
      hud.textContent = 'canvas OK · moving dot';

      // якоря для твоего скрипта
      window.__PARTICLES_MOUNT  = document.getElementById('app');
      window.__PARTICLES_CANVAS = c;

      // логируем все ошибки выполнения, чтобы не терялись
      window.addEventListener('error', e => console.error('[runtime error]', e.message));
      window.addEventListener('unhandledrejection', e => console.error('[promise]', e.reason));
    })();

    // 1) пробуем обычный скрипт
    (function loadClassic() {
      const s = document.createElement('script');
      s.src = './particles_v6.js?v=probe2';
      s.defer = true;
      s.onload  = () => console.log('[classic] particles_v6.js loaded');
      s.onerror = () => console.warn('[classic] failed to load particles_v6.js');
      document.body.appendChild(s);
    })();

    // 2) параллельно пробуем как ES-модуль
    (function loadModule() {
      const s = document.createElement('script');
      s.type = 'module';
      s.src  = './particles_v6.js?v=probe2m';
      s.onload  = () => console.log('[module] particles_v6.js loaded');
      s.onerror = () => console.warn('[module] failed to load particles_v6.js');
      document.body.appendChild(s);
    })();

    // через секунду проверим, оставил ли твой скрипт какие-то флаги
    setTimeout(() => {
      console.log('[probe] __particleSystemActive =', window.__particleSystemActive);
      console.log('[probe] globals:', Object.keys(window).filter(k => k.toLowerCase().includes('particle')));
    }, 1000);
  </script>
</body>
</html>





